var Xe=Object.defineProperty,Ye=Object.defineProperties;var Re=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable;var fe=(e,t,s)=>t in e?Xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,N=(e,t)=>{for(var s in t||(t={}))ze.call(t,s)&&fe(e,s,t[s]);if(he)for(var s of he(t))Je.call(t,s)&&fe(e,s,t[s]);return e},te=(e,t)=>Ye(e,Re(t));var ye=(e,t,s)=>new Promise((p,_)=>{var x=k=>{try{d(s.next(k))}catch(v){_(v)}},l=k=>{try{d(s.throw(k))}catch(v){_(v)}},d=k=>k.done?p(k.value):Promise.resolve(k.value).then(x,l);d((s=s.apply(e,t)).next())});import{dV as qe,dW as We,dX as Ze,b as re,i as q,dY as Ge,B as Qe,O as M,Q as j,o as F,c as U,D as r,T as et,s as O,y as ne,z as H,X as pe,Y as ke,Z as tt,n as ge,f as g,dZ as nt,F as W,q as lt,dn as st,a2 as at,a3 as ct,d_ as rt,cF as J,bJ as Z,cN as it,dz as ot,c0 as dt,d$ as ut,d9 as ht,e0 as xe,m as me,j as ft,p as Te,J as we,e1 as yt,e2 as pt,a4 as kt,a6 as ve,a7 as z,bH as gt,a0 as le,e3 as xt,dF as vt,C as V,e4 as St,I as bt,cA as Kt,w as Se,x as be,S as Ct,A as Lt,dB as Ke,e5 as At,bN as Ce,bT as _t}from"./index.1ff435d0.js";import{n as Et,c as ae,r as mt,o as Tt,j as wt}from"./lodash.80b4ff01.js";import{b as Bt}from"./index.6519c13a.js";import{D as Dt}from"./index.cc56fae8.js";function ce(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((s,p)=>s+ce(e,p),""):Object.keys(t).reduce((s,p)=>s+(t[p]?ce(e,p):""),""):""}function It(e){return(t,s)=>(t&&typeof t!="string"&&(s=t,t=""),t=t?`${e}__${t}`:e,`${t}${ce(t,s)}`)}function Be(e){return[It(`${qe}-${e}`)]}const Le=Symbol(),Ae=Symbol();function Ft(e,t){if(!We(e)||!!e[Ae])return e;const{values:s,required:p,default:_,type:x,validator:l}=e,d=s||l?k=>{let v=!1,b=[];if(s&&(b=[...s,_],v||(v=b.includes(k))),l&&(v||(v=l(k))),!v&&b.length>0){const o=[...new Set(b)].map(n=>JSON.stringify(n)).join(", ");Ze(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${o}], got value ${JSON.stringify(k)}.`)}return v}:void 0;return{type:typeof x=="object"&&Object.getOwnPropertySymbols(x).includes(Le)?x[Le]:x,required:!!p,default:_,validator:d,[Ae]:!0}}const Mt=e=>Et(Object.entries(e).map(([t,s])=>[t,Ft(s,t)]));var m=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(m||{});const Nt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],$t=Mt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),Ot={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},jt=re({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const s=e,p=q(""),[_]=Be("tree-header"),x=Ge(),{t:l}=Qe(),d=M(()=>{const n=x.headerTitle||s.title;return["mr-1","w-full",{["ml-5"]:n}]}),k=M(()=>{const{checkable:n}=s,a=[{label:l("component.tree.expandAll"),value:m.EXPAND_ALL},{label:l("component.tree.unExpandAll"),value:m.UN_EXPAND_ALL,divider:n}];return n?[{label:l("component.tree.selectAll"),value:m.SELECT_ALL},{label:l("component.tree.unSelectAll"),value:m.UN_SELECT_ALL,divider:n},...a,{label:l("component.tree.checkStrictly"),value:m.CHECK_STRICTLY},{label:l("component.tree.checkUnStrictly"),value:m.CHECK_UN_STRICTLY}]:a});function v(n){var i,u,h,f;const{key:a}=n;switch(a){case m.SELECT_ALL:(i=s.checkAll)==null||i.call(s,!0);break;case m.UN_SELECT_ALL:(u=s.checkAll)==null||u.call(s,!1);break;case m.EXPAND_ALL:(h=s.expandAll)==null||h.call(s,!0);break;case m.UN_EXPAND_ALL:(f=s.expandAll)==null||f.call(s,!1);break;case m.CHECK_STRICTLY:t("strictly-change",!1);break;case m.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function b(n){t("search",n)}const o=dt(b,200);return j(()=>p.value,n=>{o(n)}),j(()=>s.searchText,n=>{n!==p.value&&(p.value=n)}),(n,a)=>(F(),U("div",{class:ge([r(_)(),"flex px-2 py-1.5 items-center"])},[r(x).headerTitle?et(n.$slots,"headerTitle",{key:0}):O("",!0),!r(x).headerTitle&&n.title?(F(),ne(r(tt),{key:1,helpMessage:n.helpMessage},{default:H(()=>[pe(ke(n.title),1)]),_:1},8,["helpMessage"])):O("",!0),n.search||n.toolbar?(F(),U("div",Ot,[n.search?(F(),U("div",{key:0,class:ge(r(d))},[g(r(nt),{placeholder:r(l)("common.searchText"),size:"small",allowClear:"",value:p.value,"onUpdate:value":a[0]||(a[0]=i=>p.value=i)},null,8,["placeholder","value"])],2)):O("",!0),n.toolbar?(F(),ne(r(ot),{key:1,onClick:a[1]||(a[1]=it(()=>{},["prevent"]))},{overlay:H(()=>[g(r(J),{onClick:v},{default:H(()=>[(F(!0),U(W,null,lt(r(k),i=>(F(),U(W,{key:i.value},[g(r(st),at(ct({key:i.value})),{default:H(()=>[pe(ke(i.label),1)]),_:2},1040),i.divider?(F(),ne(r(rt),{key:0})):O("",!0)],64))),128))]),_:1})]),default:H(()=>[g(r(Z),{icon:"ion:ellipsis-vertical"})]),_:1})):O("",!0)])):O("",!0)],2))}}),Pt=({icon:e})=>e?ut(e)?ht(Z,{icon:e,class:"mr-1"}):Z:null;function Ut(e,t){function s(o){const n=[],a=o||r(e),{key:i,children:u}=r(t);if(!u||!i)return n;for(let h=0;h<a.length;h++){const f=a[h];n.push(f[i]);const S=f[u];S&&S.length&&n.push(...s(S))}return n}function p(o){const n=[],a=o||r(e),{key:i,children:u}=r(t);if(!u||!i)return n;for(let h=0;h<a.length;h++){const f=a[h];f.disabled!==!0&&f.selectable!==!1&&n.push(f[i]);const S=f[u];S&&S.length&&n.push(...p(S))}return n}function _(o,n){const a=[],i=n||r(e),{key:u,children:h}=r(t);if(!h||!u)return a;for(let f=0;f<i.length;f++){const S=i[f],E=S[h];o===S[u]?(a.push(S[u]),E&&E.length&&a.push(...s(E))):E&&E.length&&a.push(..._(o,E))}return a}function x(o,n,a){if(!o)return;const i=a||r(e),{key:u,children:h}=r(t);if(!(!h||!u))for(let f=0;f<i.length;f++){const S=i[f],E=S[h];if(S[u]===o){i[f]=N(N({},i[f]),n);break}else E&&E.length&&x(o,n,S[h])}}function l(o=1,n,a=1){if(!o)return[];const i=[],u=n||r(e)||[];for(let h=0;h<u.length;h++){const f=u[h],{key:S,children:E}=r(t),G=S?f[S]:"",P=E?f[E]:[];i.push(G),P&&P.length&&a<o&&(a+=1,i.push(...l(o,P,a)))}return i}function d({parentKey:o=null,node:n,push:a="push"}){const i=ae(r(e));if(!o){i[a](n),e.value=i;return}const{key:u,children:h}=r(t);!h||!u||(xe(i,f=>{if(f[u]===o)return f[h]=f[h]||[],f[h][a](n),!0}),e.value=i)}function k({parentKey:o=null,list:n,push:a="push"}){const i=ae(r(e));if(!(!n||n.length<1))if(o){const{key:u,children:h}=r(t);if(!h||!u)return;xe(i,f=>{if(f[u]===o){f[h]=f[h]||[];for(let S=0;S<n.length;S++)f[h][a](n[S]);return e.value=i,!0}})}else for(let u=0;u<n.length;u++)i[a](n[u])}function v(o,n){if(!o)return;const a=n||r(e),{key:i,children:u}=r(t);if(!(!u||!i))for(let h=0;h<a.length;h++){const f=a[h],S=f[u];if(f[i]===o){a.splice(h,1);break}else S&&S.length&&v(o,f[u])}}function b(o,n,a){return!o&&o!==0?null:((n||r(e)).forEach(u=>{if((a==null?void 0:a.key)||(a==null?void 0:a.key)===0)return a;if(u.key===o){a=u;return}u.children&&u.children.length&&(a=b(o,u.children,a))}),a||null)}return{deleteNodeByKey:v,insertNodeByKey:d,insertNodesByKey:k,filterByLevel:l,updateNodeByKey:x,getAllKeys:s,getChildrenKeys:_,getEnabledKeys:p,getSelectedNode:b}}function Ht(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!we(e)}const se="context-menu",Vt={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},_e=e=>{const{item:t}=e;return g("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&g(Z,{class:"mr-2",icon:t.icon},null),g("span",null,[t.label])])};var Xt=re({name:"ContextMenu",props:Vt,setup(e){const t=q(null),s=q(!1),p=M(()=>{const{axis:l,items:d,styles:k,width:v}=e,{x:b,y:o}=l||{x:0,y:0},n=(d||[]).length*40,a=v,i=document.body,u=i.clientWidth<b+a?b-a:b,h=i.clientHeight<o+n?o-n:o;return te(N({},k),{position:"absolute",width:`${v}px`,left:`${u+1}px`,top:`${h+1}px`,zIndex:9999})});me(()=>{ft(()=>s.value=!0)}),Te(()=>{const l=r(t);l&&document.body.removeChild(l)});function _(l,d){const{handler:k,disabled:v}=l;v||(s.value=!1,d==null||d.stopPropagation(),d==null||d.preventDefault(),k==null||k())}function x(l){return l.filter(k=>!k.hidden).map(k=>{const{disabled:v,label:b,children:o,divider:n=!1}=k,a={item:k,handler:_,showIcon:e.showIcon};return!o||o.length===0?g(W,null,[g(J.Item,{disabled:v,class:`${se}__item`,key:b},{default:()=>[g(_e,a,null)]}),n?g(Dt,{key:`d-${b}`},null):null]):r(s)?g(J.SubMenu,{key:b,disabled:v,popupClassName:`${se}__popup`},{title:()=>g(_e,a,null),default:()=>x(o)}):null})}return()=>{let l;if(!r(s))return null;const{items:d}=e;return g("div",{class:se},[g(J,{inlineIndent:12,mode:"vertical",ref:t,style:r(p)},Ht(l=x(d))?l:{default:()=>[l]})])}}});const $={domList:[],resolve:()=>{}},Yt=function(e){const{event:t}=e||{};if(t&&(t==null||t.preventDefault()),!!yt)return new Promise(s=>{const p=document.body,_=document.createElement("div"),x={};e.styles&&(x.styles=e.styles),e.items&&(x.items=e.items),e.event&&(x.customEvent=t,x.axis={x:t.clientX,y:t.clientY});const l=g(Xt,x);pt(l,_);const d=function(){$.resolve("")};$.domList.push(_);const k=function(){$.domList.forEach(v=>{try{v&&p.removeChild(v)}catch(b){}}),p.removeEventListener("click",d),p.removeEventListener("scroll",d)};$.resolve=function(v){k(),s(v)},k(),p.appendChild(_),p.addEventListener("click",d),p.addEventListener("scroll",d)})},Ee=function(){$&&($.resolve(""),$.domList=[])};function Rt(e=!0){return kt()&&e&&Te(()=>{Ee()}),[Yt,Ee]}function zt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!we(e)}var Qt=re({name:"BasicTree",inheritAttrs:!1,props:$t,emits:Nt,setup(e,{attrs:t,slots:s,emit:p,expose:_}){const[x]=Be("tree"),l=ve({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),d=ve({startSearch:!1,searchText:"",searchData:[]}),k=q([]),[v]=Rt(),b=M(()=>{const{fieldNames:c}=e;return N({children:"children",title:"title",key:"key"},c)}),o=M(()=>{let c=te(N(N({blockNode:!0},t),e),{expandedKeys:l.expandedKeys,selectedKeys:l.selectedKeys,checkedKeys:l.checkedKeys,checkStrictly:l.checkStrictly,fieldNames:r(b),"onUpdate:expandedKeys":y=>{l.expandedKeys=y,p("update:expandedKeys",y)},"onUpdate:selectedKeys":y=>{l.selectedKeys=y,p("update:selectedKeys",y)},onCheck:(y,C)=>{let K=z(l.checkedKeys);if(gt(K)&&d.startSearch){const{key:A}=r(b);K=mt(K,G(C.node.$attrs.node[A])),C.checked&&K.push(C.node.$attrs.node[A]),l.checkedKeys=K}else l.checkedKeys=y;const L=z(l.checkedKeys);p("update:value",L),p("check",L,C)},onRightClick:Fe});return Tt(c,"treeData","class")}),n=M(()=>d.startSearch?d.searchData:r(k)),a=M(()=>!n.value||n.value.length===0),{deleteNodeByKey:i,insertNodeByKey:u,insertNodesByKey:h,filterByLevel:f,updateNodeByKey:S,getAllKeys:E,getChildrenKeys:G,getEnabledKeys:P,getSelectedNode:De}=Ut(k,b);function Ie(c,y){return!y&&e.renderIcon&&le(e.renderIcon)?e.renderIcon(c):y}function Fe(C){return ye(this,arguments,function*({event:c,node:y}){var B;const{rightMenuList:K=[],beforeRightClick:L}=e;let A={event:c,items:[]};if(L&&le(L)){let T=yield L(y,c);Array.isArray(T)?A.items=T:Object.assign(A,T)}else A.items=K;!((B=A.items)!=null&&B.length)||(A.items=A.items.filter(T=>!T.hidden),v(A))})}function X(c){l.expandedKeys=c}function Me(){return l.expandedKeys}function ie(c){l.selectedKeys=c}function Ne(){return l.selectedKeys}function oe(c){l.checkedKeys=c}function $e(){return l.checkedKeys}function de(c){l.checkedKeys=c?P():[]}function Q(c){l.expandedKeys=c?E():[]}function Oe(c){l.checkStrictly=c}j(()=>e.searchValue,c=>{c!==d.searchText&&(d.searchText=c)},{immediate:!0}),j(()=>e.treeData,c=>{c&&ee(d.searchText)});function ee(c){if(c!==d.searchText&&(d.searchText=c),p("update:searchValue",c),!c){d.startSearch=!1;return}const{filterFn:y,checkable:C,expandOnSearch:K,checkOnSearch:L,selectedOnSearch:A}=r(e);d.startSearch=!0;const{title:B,key:T}=r(b),D=[];if(d.searchData=xt(r(k),w=>{var Y,R;const I=y?y(c,w,r(b)):(R=(Y=w[B])==null?void 0:Y.includes(c))!=null?R:!1;return I&&D.push(w[T]),I},r(b)),K){const w=vt(d.searchData).map(I=>I[T]);w&&w.length&&X(w)}L&&C&&D.length&&oe(D),A&&D.length&&ie(D)}function je(c,y){if(!(!e.clickRowToExpand||!y||y.length===0))if(!l.expandedKeys.includes(c))X([...l.expandedKeys,c]);else{const C=[...l.expandedKeys],K=C.findIndex(L=>L===c);K!==-1&&C.splice(K,1),X(C)}}V(()=>{k.value=e.treeData}),me(()=>{const c=parseInt(e.defaultExpandLevel);c>0?l.expandedKeys=f(c):e.defaultExpandAll&&Q(!0)}),V(()=>{l.expandedKeys=e.expandedKeys}),V(()=>{l.selectedKeys=e.selectedKeys}),V(()=>{l.checkedKeys=e.checkedKeys}),j(()=>e.value,()=>{l.checkedKeys=z(e.value||[])},{immediate:!0}),j(()=>l.checkedKeys,()=>{const c=z(l.checkedKeys);p("update:value",c),p("change",c)}),V(()=>{l.checkStrictly=e.checkStrictly});const Pe={setExpandedKeys:X,getExpandedKeys:Me,setSelectedKeys:ie,getSelectedKeys:Ne,setCheckedKeys:oe,getCheckedKeys:$e,insertNodeByKey:u,insertNodesByKey:h,deleteNodeByKey:i,updateNodeByKey:S,getSelectedNode:De,checkAll:de,expandAll:Q,filterByLevel:c=>{l.expandedKeys=f(c)},setSearchValue:c=>{ee(c)},getSearchValue:()=>d.searchText};function Ue(c){const{actionList:y}=e;if(!(!y||y.length===0))return y.map((C,K)=>{var A;let L=!0;return le(C.show)?L=(A=C.show)==null?void 0:A.call(C,c):Ce(C.show)&&(L=C.show),L?g("span",{key:K,class:x("action")},[C.render(c)]):null})}const He=M(()=>{const c=ae(n.value);return St(c,(y,C)=>{var ue;const K=d.searchText,{highlight:L}=r(e),{title:A,key:B,children:T}=r(b),D=Ie(y,y.icon),w=wt(y,A),I=K?w.indexOf(K):-1,Y=d.startSearch&&!At(K)&&L&&I!==-1,R=`color: ${Ce(L)?"#f50":L}`,Ve=Y?g("span",{class:(ue=r(o))!=null&&ue.blockNode?`${x("content")}`:""},[g("span",null,[w.substr(0,I)]),g("span",{style:R},[K]),g("span",null,[w.substr(I+K.length)])]):w;return y[A]=g("span",{class:`${x("title")} pl-2`,onClick:je.bind(null,y[B],y[T])},[s!=null&&s.title?_t(s,"title",y):g(W,null,[D&&g(Pt,{icon:D},null),Ve,g("span",{class:x("actions")},[Ue(y)])])]),y}),c});return _(Pe),()=>{let c;const{title:y,helpMessage:C,toolbar:K,search:L,checkable:A}=e,B=y||K||L||s.headerTitle,T={height:"calc(100% - 38px)"};return g("div",{class:[x(),"h-full",t.class]},[B&&g(jt,{checkable:A,checkAll:de,expandAll:Q,title:y,search:L,toolbar:K,helpMessage:C,onStrictlyChange:Oe,onSearch:ee,searchText:d.searchText},zt(c=bt(s))?c:{default:()=>[c]}),g(Kt,{spinning:r(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[Se(g(Ct,{style:T},{default:()=>[g(Bt,Lt(r(o),{showIcon:!1,treeData:He.value}),null)]}),[[be,!r(a)]]),Se(g(Ke,{image:Ke.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[be,r(a)]])]})])}}});export{Qt as _};
